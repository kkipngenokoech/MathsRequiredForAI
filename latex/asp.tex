\documentclass{article}
\usepackage{amsmath}
\usepackage{ulem}
\usepackage{amssymb}
\usepackage{listings}
\usepackage{forest}


\title{Applied Stochastic Processes}
\author{Kipngeno Koech (bkoech - andrew ID)}
\date{\today}

\begin{document}

\maketitle

\begin{center}
    \large \textbf{Question 2: Eigenvalues and Eigenvectors}
\end{center}
You are analyzing a system modeled by a 3x3 state transition matrix, which represents the interaction
of three interconnected features in a neural network, given by:

\[
B =
\begin{pmatrix}
4 & 2 & 1 \\
1 & 3 & 2 \\
0 & 1 & 2
\end{pmatrix}
\]

To get the eigenvectors, you use the formula \(\det(B - \lambda I) = 0\) where \(I\) is the identity matrix.

\section{Eigen Values}
The eigenvalues of the matrix \(B\) are given by the roots of the equation \(\det(B - \lambda I) = 0\).
\(\det(B - \lambda I) = 0\) is given by:

\[
\det\begin{vmatrix}
4-\lambda & 2 & 1 \\
1 & 3-\lambda & 2 \\
0 & 1 & 2-\lambda
\end{vmatrix} = 0
\]

\[(4-\lambda)\uline{((3-\lambda)(2-\lambda) - 2)} - 2(2-\lambda) + 1  = 0\]
\[(4-\lambda)(6 - 5\lambda + \lambda^2 - 2) - \uline{2(2-\lambda)} + 1 = 0\]
\[(4-\lambda)(4 - 5\lambda + \lambda^2) -\uline{4} + 2\lambda + \uline{1} = 0\]
\[\uline{(4-\lambda)(4 - 5\lambda + \lambda^2)} + 2\lambda - 3 = 0\]
\[4(4 - 5\lambda + \lambda^2) - \lambda(4 - 5\lambda + \lambda^2) + 2\lambda - 3 = 0\]
\[16 - 20\lambda + 4\lambda^2 - 4\lambda + 5\lambda^2 - \lambda^3 + 2\lambda - 3 = 0\]
\[-\lambda^3 + 9\lambda^2 - 18\lambda + 13 = 0\]
\[\lambda^3 - 9\lambda^2 + 18\lambda - 13 = 0\]

The roots of the equation \(\lambda^3 - 9\lambda^2 + 18\lambda - 13 = 0\) are the eigenvalues of the matrix \(B\):
\[\lambda_1 \approx 5.33005874, \quad \lambda_2 \approx 2.79836032, \quad \lambda_3 \approx 0.87158094\]

since all the three eigen values are positive, the system is unstable

\section{Modification of the off diagonal elements of the matrix}

let us say the off-diagonal elements of the matrix are modified to be \(0.5\) as follows:
\[\begin{pmatrix}
4 & 0.5 & 0.5 \\
0.5 & 3 & 0.5 \\
0.5 & 0.5 & 2
\end{pmatrix}\]

The eigenvalues of the matrix \(B\) are given by the roots of the equation \(\det(B - \lambda I) = 0\). which is given by:

the matrix \(B\) is given by:
\[\begin{vmatrix}
4-\lambda & 0.5 & 0.5 \\
0.5 & 3-\lambda & 0.5 \\
0.5 & 0.5 & 2-\lambda
\end{vmatrix} = 0\]
\[4-\lambda\uline{((3-\lambda)(2-\lambda) - 0.5^2)} - \uline{0.5((0.5(2-\lambda) - 0.5(0.5)))} + 0.5(\uline{(0.5)(0.5)-0.5(3-\lambda)}) = 0\]
\[(4-\lambda)(6 - 5\lambda + \lambda^2 - 0.5^2) - 0.5(0.75-0.5\lambda) + 0.5(0.5\lambda -1.25) = 0\]
\[4(6 - 5\lambda + \lambda^2 - 0.25) -\lambda(6-5\lambda + \lambda^2 - 0.25) - 0.375 + 0.25\lambda + 0.25\lambda - 1.25 = 0\]
\[24 - 20\lambda + 4\lambda^2 - 1 - 6\lambda + 5\lambda^2 - \lambda^3 + 0.25\lambda - 0.375 + 0.25\lambda - 1.25 = 0\]
\[-\lambda^3 + 9\lambda^2 - 18\lambda + 13 = 0\]

The roots of the equation \(\lambda^3 - 9\lambda^2 + 18\lambda - 13 = 0\) are the eigenvalues of the matrix \(B\):
\[\lambda_1 \approx 5.33005874, \quad \lambda_2 \approx 2.79836032, \quad \lambda_3 \approx 0.87158094\]

the eigen values still remain the same, hence the system is still unstable

\begin{center}
    \large \textbf{Question 3: Markov Chains}
\end{center}

The transition matrix for a Markov chain is given by:
\[Q=\begin{pmatrix}
0.7 & 0.2 & 0.1 \\
0.3 & 0.4 & 0.3 \\
0.2 & 0.5 & 0.3
\end{pmatrix}\]

It is modelling the transition of a system between three states high performance, medium performance, low performance, for employees respectively.


initial state is given by: \(\pi_0 = \begin{pmatrix} 0.5 & 0.3 & 0.2 \end{pmatrix}\)

\section{find the state of the system after 1 step}
The state of the system after 1 step is given by:
\[\pi_1 = \pi_0Q\]
\[\pi_1 = \begin{pmatrix} 0.5 & 0.3 & 0.2 \end{pmatrix}\begin{pmatrix}0.7 & 0.2 & 0.1 \\ 0.3 & 0.4 & 0.3 \\ 0.2 & 0.5 & 0.3\end{pmatrix}\]
\[\pi_1 = \begin{pmatrix}
0.5(0.7) + 0.3(0.3) + 0.2(0.2) & 0.5(0.2) + 0.3(0.4) + 0.2(0.5) & 0.5(0.1) + 0.3(0.3) + 0.2(0.3)
\end{pmatrix}\]

\[\pi_1 = \begin{pmatrix}0.48 & 0.32 & 0.2\end{pmatrix}\]

\section{steady state distribution}
The steady state distribution is given by:
\[\pi Q= \pi\]
\[\begin{pmatrix}
\pi_a & \pi_b & \pi_c
\end{pmatrix}\begin{pmatrix}07 & 0.2 & 0.1 \\ 0.3 & 0.4 & 0.3 \\ 0.2 & 0.5 & 0.3\end{pmatrix} = \begin{pmatrix} \pi_a & \pi_b & \pi_c \end{pmatrix}\]
also:
\[\pi_a + \pi_b + \pi_c = 1 -\text{ since the sum of the probabilities must be 1 }\]
The  above matrix equation can be written as:
\[\pi_a(0.7) + \pi_b(0.3) + \pi_c(0.2) = \pi_a \ldots \text{equation 1}\]
\[\pi_a(0.2) + \pi_b(0.4) + \pi_c(0.5) = \pi_b \ldots\text{equation 2}\]
\[\pi_a(0.1) + \pi_b(0.3) + \pi_c(0.3) = \pi_c \ldots\text{equation 3}\]
\[\pi_a + \pi_b + \pi_c = 1 \ldots\text{equation 4}\]

with this system of equations, we can solve for the steady state distribution. The solution is given by:

step 1: we can rewrite the equations as:
\[\pi_a(0.7 - 1) + \pi_b(0.3) + \pi_c(0.2) = 0 \ldots\text{equation 1}\]
\[\pi_a(0.2) + \pi_b(0.4 - 1) + \pi_c(0.5) = 0 \ldots\text{equation 2}\]
\[\pi_a(0.1) + \pi_b(0.3) + \pi_c(0.3 - 1) = 0 \ldots\text{equation 3}\]
\[\pi_a + \pi_b + \pi_c = 1 \ldots\text{equation 4}\]

this is equivalent to:
\[-(0.3)\pi_a + (0.3)\pi_b + (0.2)\pi_c = 0 \ldots\text{equation 1}\]
\[0.2\pi_a + -(0.3)\pi_b + (0.5)\pi_c = 0 \ldots\text{equation 2}\]
\[0.1\pi_a + (0.3)\pi_b + -(0.7)\pi_c = 0 \ldots\text{equation 3}\]

multiply equation 1 by 10, equation 2 by 10 and equation 3 by 10:
\[-3\pi_a + 3\pi_b + 2\pi_c = 0 \ldots\text{equation 1}\]
\[2\pi_a - 3\pi_b + 5\pi_c = 0 \ldots\text{equation 2}\]
\[\pi_a + 3\pi_b - 7\pi_c = 0 \ldots\text{equation 3}\]
\[\pi_a + \pi_b + \pi_c = 1 \ldots\text{equation 4}\]

we can write \[\pi_a = 1 - \pi_b - \pi_c\] and substitute in the above equations to get:
\[-3(1 - \pi_b - \pi_c) + 3\pi_b + 2\pi_c = 0 \ldots\text{equation 1}\]
\[2(1 - \pi_b - \pi_c) - 3\pi_b + 5\pi_c = 0 \ldots\text{equation 2}\]
\[1 - \pi_b - \pi_c + 3\pi_b - 7\pi_c = 0 \ldots\text{equation 3}\]

let us expand equation 1:
\[-3 + 3\pi_b + 3\pi_c + 3\pi_b + 2\pi_c = 0\]
\[-3 + 6\pi_b + 5\pi_c = 0\]
\[6\pi_b + 5\pi_c = 3 \ldots\text{equation 5}\]

let us expand equation 2:
\[2 - 2\pi_b - 2\pi_c - 3\pi_b + 5\pi_c = 0\]
\[2 - 5\pi_b + 3\pi_c = 0\]
\[-5\pi_b + 3\pi_c = -2 \ldots\text{equation 6}\]

the above equation 5 and 6 can be written as:
\[\begin{pmatrix}6&5\\-5&3\end{pmatrix}\begin{pmatrix}\pi_b\\\pi_c\end{pmatrix} = \begin{pmatrix}3\\-2\end{pmatrix}\]
its argumented matrix is:
\[\begin{pmatrix}6&5&|&3\\-5&3&|&-2\end{pmatrix}\]
by row reduction, we get:
\[R_1 => \frac{1}{6}R_1 => \begin{pmatrix}1&\frac{5}{6}&|&\frac{1}{2}\\-5&3&|&-2\end{pmatrix}\]
\[R_2 => R_2 + 5R_1 => \begin{pmatrix}1&\frac{5}{6}&|&\frac{1}{2}\\0&\frac{43}{6}&|&\frac{1}{2}\end{pmatrix}\]
\[R_2 => \frac{6}{43}R_2 => \begin{pmatrix}1&\frac{5}{6}&|&\frac{1}{2}\\0&1&|&\frac{3}{43}\end{pmatrix}\]
\[R_1 => R_1 - \frac{5}{6}R_2 => \begin{pmatrix}1&0&|&\frac{19}{43}\\0&1&|&\frac{9}{43}\end{pmatrix}\]

this gives us:
\[\pi_b = \frac{19}{43}, \quad \pi_c = \frac{9}{43}\]
\[\Pi_a = 1 - \frac{19}{43} - \frac{9}{43} = \frac{15}{43}\]

therefore the steady state distribution is given by:
\[\pi = \begin{pmatrix}\frac{15}{43}&\frac{19}{43}&\frac{9}{43}\end{pmatrix}\]


A lot of employees are in the medium performance state, while the least number of employees are in the low performance state. The high performance state has the second highest number of employees. So the company might introduce Initiatives to push the medium performance employees to high performance state and the low performance employees to medium performance state.

\begin{center}
    \large \textbf{Question 6: Conditional Probability}
\end{center}
\section{storyline}
An insurance company examines its pool of auto insurance customers and makes the following observations:
\begin{itemize}
    \item All customers insure at least one car
    \item 70\% of the customers insure more than one car
    \item 20\% of the customers insure a sports car
    \item of those customers who insure more than one car, 15\% insure a sports car
\end{itemize}

\section{find the probability that a randomly chosen customer insures one car and it is not a sports car}

for Conditional probability, the formula is:
\[P(A|B) = \frac{P(A \cap B)}{P(B)}\]

let \(A\) be the event that a customer insures one car and \(B\) be the event that the customer insure a sports car.

let us list out the probability of the events we have:

\begin{itemize}
    \item \(P(A) = 0.3\) = probability that a customer insures one car
    \item \(P(A^c) = 0.7\) = probability that a customer insures more than one car
    \item \(P(B) = 0.2\) = probability that a customer insures a sports car
    \item \(P(B^c = 0.8)\) = probability that a customer does not insure a sports car
    \item \(P(A^c \cap B) = 0.105\) = probability that a customer insures more than one car and it is a sports car
    \item \(P(A^c \cap B^c ) = 0.595\) = probability that a customer insures more than one car and it is not a sports car
\end{itemize}

this is how the tree diagram looks like:

\begin{forest}
    for tree={grow=east,
    edge={-latex, line width=1pt},
    parent anchor=east,
    child anchor=west,
    align=center,
    anchor=west,
    l sep+=10pt,
    s sep+=10pt,
    inner sep=2pt,}
    [Customer
    [One Car, edge label={node[midway,left]{0.3}}
    [Not a sports car, edge label={{node[midway,left]{0.8}}}, label=right:{= \(P(A \cap B^c) = 0.24\)}]
    [Sports car, edge label={{node[midway,left]{0.2}}}, label=right:{= \(P(A \cap B) = 0.06\)}]
]
        [More than one car, edge label={node[midway,left]{0.7}}
            [Not a sports car, edge label={node[midway,left]{0.85}}, label=right:{= \(P(A^c \cap B^c) = 0.595\)}]
            [Sports car, edge label={node[midway,left]{0.15}}, label=right:{= \(P(A^c \cap B) = 0.105\)}]
        ]
    ]
\end{forest}


so, let us do the calculations:


What is the probability that a customer insures one car and it is a sports car? this are dependent events
\begin{itemize}
   \item \(P(B^c = 0.8)\) = probability that a customer does not insure a sports car
   \item \(P(B^c|A) = \frac{P(B^c \cap A)}{P(A)}\) = probability that a customer insures one car and it is not a sports car
   \item \(P(B^c \cap A) = P(A) - P(A \cap B) = 0.3 - (0.3 \times 0.2) = 0.24\) = probability that a customer insures one car and it is not a sports car
   \item \(P(A \cap B) = P(A) \times P(B) = 0.3 \times 0.2 = 0.06\) = probability that a customer insures one car and it is a sports car
\end{itemize}

Therefore the probability that a randomly chosen customer insures one car and it is not a sports car is \(\mathbf{0.24}\)

\begin{center}
    \large \textbf{Question 7: Bayes Theorem}
\end{center}

\section{storyline}

Bayes Theorem = \(P(A|B) = \frac{P(B|A)P(A)}{P(B)}\)

(a) (4 points) A medical test for a new strain of a viral respiratory disease has a 98\% sensitivity and
a 97\% specificity. If 0.5\% of the population has the disease, calculate the probability that a person
has the disease given they tested positive.

\begin{itemize}
    \item \(P(D) = 0.005\) = probability that a person has the disease
    \item \(P(D^c) = 0.995\) = probability that a person does not have the disease
    \item \(P(T|D) = 0.98\) = probability that a person tests positive given they have the disease
    \item \(P(T|D^c) = 0.03\) = probability that a person tests positive given they do not have the disease
    \item \(P(T) = P(T|D)P(D) + P(T|D^c)P(D^c) = (0.98 \times 0.005) + (0.03 \times 0.995) = 0.03475\) = probability that a person tests positive
    \item \(P(D/T) = \frac{P(T|D)P(D)}{P(T)} = \frac{0.98 \times 0.005}{0.03475} \approx 0.141\)
\end{itemize}


(b) (4 points) A financial credit scoring model is 95 percent effective in identifying individuals who
are likely to default on their loans when they actually will default. However, the model also yields a
“false positive” result for 1 percent of individuals who are creditworthy. (That is, if a creditworthy
individual is tested, then, with probability 0.01, the model will incorrectly classify them as likely
to default.) If 0.5 percent of the population actually defaults on their loans, what is the probability
that an individual will default given that the model predicts they are likely to default?

\begin{itemize}
    \item \(P(E) = 0.005\) = probability that an individual will default on their loans
    \item \(P(E|D) = 0.95\) = probability that an individual will default on their loans given they actually will default
    \item \(P(D) = P(E|D) \cdot P(D) + P(E|D^c) \cdot P(D^c)\) = probability that an individual will default on their loans
    \item \(P(E|D^c) = 0.01\) = probability that an individual will default on their loans given they are creditworthy
    \item \(P(E) = (0.95)(0.005) + (0.01)(0.995)\)
    \item \(P(D) = 0.0147\) = probability that an individual will default on their loans
\end{itemize}

Bayes Theorem = \(P(D|E) = \frac{P(E|D)P(D)}{P(E)} = \frac{0.95 \times 0.005}{0.0147} \approx 0.323\)

\begin{center}
    \large \textbf{Question 8: Independence of Events, Inclusion-Exclusion Principle \& Mutual Exclusivity}
\end{center}

\section{Positive probabilities \& Independent events}
show that if A \& B are events with positive probabilities, then so are:

1. \(A^c\) and B 

for indepedent events: \(P(A \cap B) = P(A) \cdot P(B)\)

\begin{center}
    \large \textbf{Question 9: Combinatorics}
\end{center}

\section{storyline}

1. calculate the number of ways to arrange the letters in the word "ALGORITHM" such that the vowels are together.

permutations: \(P(n) = \frac{n!}{(n-r)!}\)

the number of letters in the word "ALGORITHM" is 8, with 3 vowels and 5 consonants.

the number of ways to arrange the vowels is \(P(3) = \frac{8!}{(8-3)!} = 336\) \newline

2. (4 points) Every fall semester, elections are held at CMU-Africa to choose members of the student
guild and other club representatives. After, the elections were held, the elected members conducted
a survey on students problems and it was revealed that tuition funding and housing ranked first.
The guild decided on decentralized task forces to address specific issues from a group of 5 females
and 7 males, how many different committees consisting of 2 females and 3 males can be formed?
What if 2 of the males are feuding and refuse to serve on the committee together?

Combinations to choose 2 females in a group of 5(here order doesn't matter): \(C(n,r) = \frac{n!}{r!(n-r)!}\)

Combinations

\(C\binom{5}{2} = \frac{5!}{2!(5-2)!} = \frac{120}{12} = 10\)

Combinations to choose 3 males in a group of 7(here order doesn't matter):

\(C\binom{7}{3} = \frac{7!}{3!(7-3)!} = \frac{5040}{144} = 35\)

Therefore the number of different committees: \(10 \times 35 = 350\)\newline

If 2 of the males refuse to work together:

\begin{center}
    \large \textbf{Question 10: LAW OF TOTAL PROBABILITY}
\end{center}

\textbf{Questions}

1. A factory produces three types of gadgets. Type A constitutes 50\%, Type B constitutes 30\%, and Type C constitutes 20\% of the total production. The defect rates for these gadgets are 1\%, 2\%, and 3\% respectively. Calculate the probability that a randomly selected gadget is defective

this is what we have:
\begin{itemize}
    \item \(P(A) = 0.5\), \(P(D) = 0.01\)
    \item \(P(B) = 0.3\), \(P(D) = 0.02\)
    \item \(p(c) = 0.2\), \(P(D) = 0.03\)
\end{itemize}

\begin{forest}
    for tree={grow=east,
    edge={-latex, line width=1pt},
    parent anchor=east,
    child anchor=west,
    align=center,
    anchor=west,
    l sep+=10pt,
    s sep+=10pt,
    inner sep=2pt,}
    [Gadgets
    [A, edge label={node[midway,left]{0.5}}
        [Not  Defective, edge label={{node[midway,left]{0.99}}}]
        [Defective, edge label={{node[midway,left]{0.03}}}]
    ]
    [B, edge label={node[midway,left]{0.2}}
        [Not  Defective, edge label={node[midway,left]{0.98}}]
        [Defective, edge label={node[midway,left]{0.02}}]
    ]
    [C, edge label={node[midway,left]{0.3}}
        [Not  Defective, edge label={node[midway,left]{0.97}}]
        [Defective, edge label={node[midway,left]{0.03}}]
    ]
    ]
\end{forest}

a probability that a randomly selected gadget is defective is given by:

\[P(D) = P(D|A)P(A) + P(D|B)P(B) + P(D|C)P(C)\] = \[0.5 \times 0.01 + 0.3 \times 0.02 + 0.2 \times 0.03 = 0.017\]

2. (4 marks) Samsung has three factories—Factory Korea, Factory Japan, and Factory USA that produce the same type of electronic component. The factory in Korea produces 50\% of the components, 30\% are produced in Japan, and the factory in the USA is responsible for 20\% of production.
The probability of a component being defective is 2\% for Factory Korea, 4\% for Factory Japan, and 5\% for Factory USA. Suppose a randomly selected component from the company’s entire production is found to be
defective. What is the probability that it was produced by Factory Japan?

This is what we have so far:

\begin{itemize}
    \item \(P(K) = 0.5\), \(P(D) = 0.02\) - Korea
    \item \(P(J) = 0.3\), \(P(D) = 0.04\) - Japan
    \item \(P(U) = 0.2\), \(P(D) = 0.05\) - USA
\end{itemize}

\begin{forest}
    for tree={grow=east,
    edge={-latex, line width=1pt},
    parent anchor=east,
    child anchor=west,
    align=center,
    anchor=west,
    l sep+=10pt,
    s sep+=10pt,
    inner sep=2pt,}
    [Factories
    [Korea, edge label={node[midway,left]{0.5}}
        [Not  Defective, edge label={{node[midway,left]{0.98}}}]
        [Defective, edge label={{node[midway,left]{0.02}}}]
    ]
    [Japan, edge label={node[midway,left]{0.3}}
        [Not  Defective, edge label={node[midway,left]{0.96}}]
        [Defective, edge label={node[midway,left]{0.04}}]
    ]
    [USA, edge label={node[midway,left]{0.2}}
        [Not  Defective, edge label={node[midway,left]{0.95}}]
        [Defective, edge label={node[midway,left]{0.05}}]
    ]
    ]
\end{forest}

the probability that a component was produced by Factory Japan given that it is defective is given by:

we first need to calculate the probability that a component is defective using law of total probability:

\[P(D) = P(D|K)P(K) + P(D|J)P(J) + P(D|U)P(U)\] = \[0.5 \times 0.02 + 0.3 \times 0.04 + 0.2 \times 0.05 = 0.032\]

\[P(J|D) = \frac{P(D|J)P(J)}{P(D)} = \frac{0.04 \times 0.3}{0.032} = \frac{0.012}{0.032} \approx 0.375\]

\end{document}